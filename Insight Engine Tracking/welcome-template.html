<!DOCTYPE html>
<html>

<head>
    <title>Document Access Portal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Anime.js Library for Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        /* --- Base Styles --- */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: "Verizon NHG TX", Arial, Helvetica, sans-serif;
            line-height: 1.5;
            margin: 0;
            background-color: #F6F6F6;
            color: #333333;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* --- Main Layout Container --- */
        .document-container {
            background-color: #FFFFFF;
            padding: 20px;
            max-width: 1400px;
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: grid;
            grid-template-columns: 320px 1fr 300px;
            gap: 25px;
            height: calc(100vh - 40px);
            max-height: 800px;
            position: relative;
        }

        /* --- Floating News Headlines Container --- */
        .news-headlines-float {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 60px;
            max-width: 400px;
        }

        .news-toggle-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border: none;
            color: white;
            padding: 16px 20px;
            cursor: pointer;
            width: 100%;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            border-radius: 0;
        }

        .news-toggle-btn:hover {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            transform: translateY(-1px);
        }

        .news-toggle-btn:active {
            transform: translateY(0);
            transition: transform 0.1s ease;
        }

        .news-toggle-btn::after {
            content: '▼';
            font-size: 12px;
            opacity: 0.8;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .news-toggle-btn.expanded::after {
            transform: rotate(180deg);
        }

        .news-content {
            background: rgba(255, 255, 255, 0.98);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .news-content.expanded {
            max-height: 400px;
        }

        .news-headline-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .news-headline-item:hover {
            background: #f8f9fa;
        }

        .news-headline-item:last-child {
            border-bottom: none;
        }

        .headline-title {
            font-weight: bold;
            font-size: 13px;
            color: #333;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .headline-meta {
            font-size: 11px;
            color: #666;
            margin-bottom: 8px;
        }

        .headline-summary {
            font-size: 12px;
            color: #555;
            line-height: 1.4;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .headline-summary.expanded {
            max-height: 200px;
            margin-bottom: 10px;
        }

        .headline-actions {
            display: flex;
            gap: 8px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .headline-actions.expanded {
            max-height: 50px;
        }

        .action-btn {
            background: #EE0000;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
        }

        .action-btn:hover {
            background: #d10000;
            transform: translateY(-1px);
        }

        .action-btn.secondary {
            background: #333;
        }

        .action-btn.secondary:hover {
            background: #000;
        }

        .news-empty {
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 12px;
        }

        /* --- Column Styles --- */
        .sidebar,
        .whats-inside,
        .main-content {
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            padding: 0 15px;
        }

        .sidebar,
        .whats-inside {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
        }

        .column-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #EE0000;
            flex-shrink: 0;
        }

        .column-header h4 {
            margin: 0;
            font-size: 14px;
            font-weight: bold;
            color: #000000;
        }

        .scrollable-content {
            overflow-y: auto;
            height: 100%;
            padding-right: 10px;
            /* For scrollbar spacing */
        }

        /* --- Header in Main Column --- */
        .header {
            background-color: #000000;
            color: #FFFFFF;
            padding: 25px 30px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .header h1 {
            margin: 0;
            font-size: 22px;
            font-weight: bold;
            animation: titlePulse 3s ease-in-out infinite alternate;
        }

        @keyframes titlePulse {
            0% {
                text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
            }

            100% {
                text-shadow: 0 0 15px rgba(255, 255, 255, 0.8), 0 0 25px rgba(238, 0, 0, 0.3);
            }
        }

        .header p {
            margin: 5px 0 0;
            opacity: 0.9;
        }

        /* --- "What's Inside" Specifics --- */
        .info-section {
            margin: 20px 0;
        }

        .info-section h5 {
            margin: 0 0 8px 0;
            font-size: 13px;
            font-weight: bold;
            color: #000000;
        }

        .info-section p,
        .info-section li {
            font-size: 12px;
            color: #333333;
        }

        .info-section strong {
            color: #EE0000;
        }

        .toc-list {
            padding-left: 20px;
            margin: 10px 0 0 0;
        }

        /* --- Main Content Specifics --- */
        .file-info-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .file-info-section h2 {
            font-size: 20px;
            margin: 0 0 5px 0;
            word-wrap: break-word;
        }

        .file-info-section p {
            font-size: 14px;
            color: #555;
            margin: 0;
        }

        .insight-engine-overview {
            background: #eef2ff;
            border: 1px solid #c7d2fe;
            border-left: 4px solid #4f46e5;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .insight-engine-overview h4 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #3730a3;
        }

        .insight-engine-overview p {
            font-size: 13px;
            line-height: 1.6;
        }

        .action-buttons-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .access-btn,
        .prompt-generator-btn {
            padding: 15px 30px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            text-align: center;
        }

        .access-btn {
            background-color: #CD040B;
            color: #FFFFFF;
        }

        .access-btn:hover {
            background-color: #a70409;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .prompt-generator-btn {
            background-color: #333333;
            color: #FFFFFF;
        }

        .prompt-generator-btn:hover {
            background-color: #000000;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        /* --- News Sidebar Specifics --- */
        .news-item {
            margin-bottom: 20px;
        }

        .news-item strong {
            display: block;
            font-size: 13px;
            color: #000;
        }

        .news-item em {
            font-size: 11px;
            color: #555;
        }

        /* --- Animations & Responsiveness --- */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .document-container {
            animation: fadeIn 0.8s ease-out;
        }

        @media (max-width: 1200px) {
            .document-container {
                grid-template-columns: 1fr 1.5fr;
            }

            .sidebar {
                display: none;
            }

            /* Hide right sidebar on medium screens */
        }

        @media (max-width: 768px) {
            body {
                padding: 0;
                align-items: flex-start;
            }

            .document-container {
                grid-template-columns: 1fr;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
                padding: 15px;
                gap: 15px;
            }

            .whats-inside {
                order: 2;
            }

            /* Move to bottom */
            .main-content {
                order: 1;
            }

            /* Mobile-specific news headlines styling */
            .news-headlines-float {
                position: fixed;
                top: 10px;
                right: 10px;
                max-width: calc(100vw - 20px);
                min-width: 50px;
                border-radius: 12px;
            }

            .news-toggle-btn {
                font-size: 12px;
                padding: 14px 16px;
                font-weight: 600;
            }

            .news-content.expanded {
                max-height: 60vh;
            }

            .headline-title {
                font-size: 12px;
            }

            .headline-meta {
                font-size: 10px;
            }

            .headline-summary {
                font-size: 11px;
            }

            .action-btn {
                font-size: 10px;
                padding: 5px 10px;
            }
        }

        /* Custom Scrollbar */
        .scrollable-content::-webkit-scrollbar {
            width: 8px;
        }

        .scrollable-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .scrollable-content::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }

        .scrollable-content::-webkit-scrollbar-thumb:hover {
            background: #aaa;
        }
    </style>
</head>

<body>
    <div class="document-container">
        <!-- Floating News Headlines Container -->
        <div class="news-headlines-float" id="newsHeadlinesFloat">
            <button class="news-toggle-btn" id="newsToggleBtn">
                <span>📰 Latest Headlines</span>
                <span class="news-toggle-icon" id="newsToggleIcon">▼</span>
            </button>
            <div class="news-content" id="newsContent">
                <div id="newsHeadlinesList">
                    <!-- News headlines will be populated here -->
                </div>
            </div>
        </div>

        <!-- "What's Inside" Column -->
        <div class="whats-inside">
            <div class="column-header">
                <span>📋</span>
                <h4>What's Inside</h4>
            </div>
            <div class="scrollable-content">
                <div class="info-section">
                    <h5>What's New</h5>
                    <p>This weekly report now includes <strong>Fixed Wireless Access (FWA)</strong> and updated
                        <strong>Second Line Activity</strong> metrics.
                    </p>
                </div>
                <div class="info-section">
                    <h5>Key Sections</h5>
                    <ul class="toc-list">
                        <li>Consumer Growth & Port Activity</li>
                        <li>Business Postpaid Performance</li>
                        <li>Prepaid Customer Growth (VVO)</li>
                        <li>Channel Mix Analysis (Direct/Indirect)</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h5>Data Source</h5>
                    <p>All data is sourced from the Enterprise Data Warehouse and is current as of {{TIMESTAMP}}.</p>
                </div>
            </div>
        </div>

        <!-- Main Content Column -->
        <div class="main-content">
            <div class="header">
                <h1>{{DOCUMENT_NAME}}</h1>
                <p>Welcome to Insight Engine</p>
            </div>
            <div class="file-info-section">
                <h2>Document Overview</h2>
                <p>Last updated: {{LAST_MODIFIED}}</p>
            </div>
            <div class="insight-engine-overview">
                <h4>🚀 About the Insight Engine</h4>
                <p>The Insight Engine is your AI-powered document analysis platform. After opening your report, leverage
                    the integrated Gemini Sidebar in Google Workspace and our advanced Prompt Generator to unlock
                    instant, intelligent insights from your data. Transform static reports into interactive, actionable
                    intelligence.</p>
            </div>
            <div class="action-buttons-section">
                <button class="access-btn" id="accessBtn" onclick="openDocument('{{FILE_URL_DIRECT}}')">🚀 Launch
                    Document & Start Analysis</button>
                <a href="#" class="prompt-generator-btn">⚡ Open AI Prompt Generator</a>
            </div>
        </div>

        <!-- News Sidebar Column -->
        <div class="sidebar">
            <div class="column-header">
                <span>📰</span>
                <h4>Latest Headlines</h4>
            </div>
            <div class="scrollable-content">
                <div id="newsContainer">
                    <!-- News items will be dynamically loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Template data injection point - DO NOT MODIFY THIS LINE
        eval('window.templateData = {{TEMPLATE_DATA_JSON}};');

        // --- Document Access Function ---
        function openDocument(url) {
            if (url) {
                // Track the access attempt
                if (window.templateData && window.templateData.TRACKING_ENABLED) {
                    console.log('Document access tracked:', window.templateData.FILE_NAME);
                }

                // Open the document
                window.open(url, '_blank');
            } else {
                alert('Document URL not available. Please try again later.');
            }
        }

        // --- Mock Data & Client-Side Logic for Preview ---
        document.addEventListener('DOMContentLoaded', () => {
            // Load news data from template data or use mock data
            let newsItems = [];

            // Get news headlines from Google Sheets data only
            if (window.templateData && window.templateData.NEWS_HEADLINES) {
                newsItems = window.templateData.NEWS_HEADLINES;
                // Populate the floating news headlines
                populateFloatingNews(newsItems);
                // Initialize floating news functionality
                initializeFloatingNews();
            } else {
                // Hide news container if no data available
                const newsContainer = document.getElementById('newsContainer');
                if (newsContainer) {
                    newsContainer.style.display = 'none';
                }
            }

            const newsContainer = document.getElementById('newsContainer');
            let newsHtml = '';
            newsItems.forEach(item => {
                newsHtml += `<div class="news-item">
                                <strong>${item.title}</strong>
                                <em>${item.source} - ${item.date}</em>
                             </div>`;
            });
            newsContainer.innerHTML = newsHtml;

            // Animate elements on load with enhanced anime.js effects
            if (typeof anime !== 'undefined') {
                // Header animation with scale and bounce
                anime({
                    targets: '.header',
                    scale: [0.8, 1],
                    opacity: [0, 1],
                    duration: 1000,
                    easing: 'easeOutElastic(1, .6)',
                    delay: 100
                });

                // File info section with slide up
                anime({
                    targets: '.file-info-section',
                    translateY: [30, 0],
                    opacity: [0, 1],
                    duration: 800,
                    easing: 'easeOutExpo',
                    delay: 300
                });

                // Insight engine overview with pulse effect
                anime({
                    targets: '.insight-engine-overview',
                    scale: [0.9, 1],
                    opacity: [0, 1],
                    duration: 1000,
                    easing: 'easeOutBack',
                    delay: 500
                });

                // Buttons with staggered animation and hover prep
                anime({
                    targets: '.action-buttons-section .access-btn, .action-buttons-section .prompt-generator-btn',
                    translateY: [40, 0],
                    opacity: [0, 1],
                    scale: [0.8, 1],
                    duration: 800,
                    delay: anime.stagger(200, { start: 700 }),
                    easing: 'easeOutBack'
                });

                // Sidebar animations
                anime({
                    targets: '.whats-inside',
                    translateX: [-50, 0],
                    opacity: [0, 1],
                    duration: 1000,
                    delay: 200,
                    easing: 'easeOutExpo'
                });

                anime({
                    targets: '.sidebar',
                    translateX: [50, 0],
                    opacity: [0, 1],
                    duration: 1000,
                    delay: 400,
                    easing: 'easeOutExpo'
                });

                // News items individual animation
                anime({
                    targets: '.news-item',
                    translateY: [20, 0],
                    opacity: [0, 1],
                    duration: 600,
                    delay: anime.stagger(100, { start: 800 }),
                    easing: 'easeOutExpo'
                });

                // Column headers with rotation effect
                anime({
                    targets: '.column-header',
                    rotateY: [90, 0],
                    opacity: [0, 1],
                    duration: 800,
                    delay: anime.stagger(150, { start: 600 }),
                    easing: 'easeOutExpo'
                });
            }

            // Add enhanced button interactions with anime.js
            const accessBtn = document.getElementById('accessBtn');
            if (accessBtn && typeof anime !== 'undefined') {
                accessBtn.addEventListener('mouseenter', () => {
                    anime({
                        targets: accessBtn,
                        scale: 1.05,
                        duration: 200,
                        easing: 'easeOutQuad'
                    });
                });

                accessBtn.addEventListener('mouseleave', () => {
                    anime({
                        targets: accessBtn,
                        scale: 1,
                        duration: 200,
                        easing: 'easeOutQuad'
                    });
                });

                accessBtn.addEventListener('click', () => {
                    anime({
                        targets: accessBtn,
                        scale: [1, 0.95, 1],
                        duration: 300,
                        easing: 'easeOutElastic(1, .6)'
                    });
                });
            }
        });

        // --- Floating News Headlines Functions ---
        function populateFloatingNews(newsItems) {
            const newsHeadlinesList = document.getElementById('newsHeadlinesList');

            if (!newsItems || newsItems.length === 0) {
                newsHeadlinesList.innerHTML = '<div class="news-empty">No news headlines available</div>';
                return;
            }

            let newsHtml = '';
            newsItems.forEach((item, index) => {
                const summary = item.summary || item.fullStory || 'No summary available';
                const fullStory = item.fullStory || item.summary || 'Full story not available';

                newsHtml += `
                    <div class="news-headline-item" data-index="${index}">
                        <div class="headline-title">${item.title}</div>
                        <div class="headline-meta">${item.source} • ${item.date}</div>
                        <div class="headline-summary" id="summary-${index}">
                            ${fullStory}
                        </div>
                        <div class="headline-actions" id="actions-${index}">
                            <a href="https://www.google.com/search?q=${encodeURIComponent(item.title + ' ' + item.source)}"
                               target="_blank" class="action-btn">
                                🔍 Google Search
                            </a>
                            <button class="action-btn secondary" onclick="shareHeadline('${item.title}', '${item.source}')">
                                📤 Share
                            </button>
                        </div>
                    </div>
                `;
            });

            newsHeadlinesList.innerHTML = newsHtml;
        }

        function initializeFloatingNews() {
            const newsToggleBtn = document.getElementById('newsToggleBtn');
            const newsContent = document.getElementById('newsContent');
            const newsToggleIcon = document.getElementById('newsToggleIcon');
            let isExpanded = false;

            // Toggle news container
            newsToggleBtn.addEventListener('click', () => {
                isExpanded = !isExpanded;

                if (isExpanded) {
                    newsContent.classList.add('expanded');
                    newsToggleIcon.classList.add('expanded');
                    newsToggleIcon.textContent = '▲';

                    // Animate the expansion
                    if (typeof anime !== 'undefined') {
                        anime({
                            targets: '.news-headlines-float',
                            scale: [0.95, 1],
                            duration: 300,
                            easing: 'easeOutBack'
                        });
                    }
                } else {
                    newsContent.classList.remove('expanded');
                    newsToggleIcon.classList.remove('expanded');
                    newsToggleIcon.textContent = '▼';

                    // Collapse all expanded headlines
                    document.querySelectorAll('.headline-summary.expanded').forEach(summary => {
                        summary.classList.remove('expanded');
                    });
                    document.querySelectorAll('.headline-actions.expanded').forEach(actions => {
                        actions.classList.remove('expanded');
                    });
                }
            });

            // Add click handlers for individual headlines
            document.addEventListener('click', (e) => {
                if (e.target.closest('.news-headline-item') && !e.target.closest('.action-btn')) {
                    const headlineItem = e.target.closest('.news-headline-item');
                    const index = headlineItem.getAttribute('data-index');
                    const summary = document.getElementById(`summary-${index}`);
                    const actions = document.getElementById(`actions-${index}`);

                    const isCurrentlyExpanded = summary.classList.contains('expanded');

                    // Collapse all other headlines first
                    document.querySelectorAll('.headline-summary.expanded').forEach(otherSummary => {
                        if (otherSummary !== summary) {
                            otherSummary.classList.remove('expanded');
                        }
                    });
                    document.querySelectorAll('.headline-actions.expanded').forEach(otherActions => {
                        if (otherActions !== actions) {
                            otherActions.classList.remove('expanded');
                        }
                    });

                    // Toggle current headline
                    if (isCurrentlyExpanded) {
                        summary.classList.remove('expanded');
                        actions.classList.remove('expanded');
                    } else {
                        summary.classList.add('expanded');
                        actions.classList.add('expanded');

                        // Animate the expansion
                        if (typeof anime !== 'undefined') {
                            anime({
                                targets: headlineItem,
                                backgroundColor: ['#f8f9fa', '#fff'],
                                duration: 200,
                                easing: 'easeOutQuad'
                            });
                        }
                    }
                }
            });

            // Initialize with floating animation
            if (typeof anime !== 'undefined') {
                anime({
                    targets: '.news-headlines-float',
                    translateY: [-20, 0],
                    opacity: [0, 1],
                    duration: 800,
                    delay: 1000,
                    easing: 'easeOutExpo'
                });
            }
        }

        function shareHeadline(title, source) {
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: `Check out this news: ${title} - ${source}`,
                    url: window.location.href
                });
            } else {
                // Fallback: copy to clipboard
                const shareText = `${title} - ${source}\n${window.location.href}`;
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Headline copied to clipboard!');
                }).catch(() => {
                    alert('Unable to share. Please copy manually:\n' + shareText);
                });
            }
        }
    </script>
</body>

</html>
